// interestUtils.ts

// 1) ê´€ì‹¬ì‚¬ë³„ í‚¤ì›Œë“œ ì‚¬ì „
const keywordMappings: Record<string, string[]> = {
  ì—­ì‚¬: [
    "ìœ ì ",
    "ê³ ê¶",
    "ì„±ê³½",
    "ì‚¬ì ì§€",
    "ë°•ë¬¼ê´€",
    "ì „í†µ",
    "ì™•ì¡°",
    "ì—­ì‚¬",
    "ê³ ëŒ€ ìœ ë¬¼",
    "ë¬¸í™”ì¬",
    "ì¡°ì„ ì‹œëŒ€",
    "ì‹ ë¼",
    "ê³ êµ¬ë ¤",
    "ë°±ì œ",
    "ê·¼ëŒ€ì‚¬",
    "ë…ë¦½ìš´ë™",
    "ì „ìŸ ì—­ì‚¬",
  ],
  ë¬¸í™”: [
    "ì¶•ì œ",
    "ì „í†µ",
    "ê³µì—°",
    "ë¬¸í™”ì¬",
    "ì§€ì—­ ë¬¸í™”",
    "í–‰ì‚¬",
    "ìœ ì ì§€",
    "í˜ìŠ¤í‹°ë²Œ",
    "ë¬¸í™” ì¶•ì œ",
    "í…Œë§ˆíŒŒí¬",
    "ì „í†µ ì˜ìƒ",
    "í•œë³µ ì²´í—˜",
    "ë¯¼ì†ì´Œ",
    "ê³µì˜ˆ ì²´í—˜",
  ],
  ì˜ˆìˆ : [
    "ì˜ˆìˆ ",
    "ë¯¸ìˆ ",
    "ìŒì•…",
    "ê³µì—°",
    "ì „ì‹œ",
    "ê°¤ëŸ¬ë¦¬",
    "ë°•ë¬¼ê´€",
    "ì¡°ê°",
    "ì„¤ì¹˜ ë¯¸ìˆ ",
    "í˜„ëŒ€ ì˜ˆìˆ ",
    "ê³µì˜ˆ",
    "ë””ìì¸",
    "í¼í¬ë¨¼ìŠ¤",
    "ì°½ì‘",
  ],
  ë””ìì¸: [
    "ë””ìì¸",
    "ê·¸ë˜í”½",
    "ê±´ì¶•",
    "ì¸í…Œë¦¬ì–´",
    "íŒ¨ì…˜",
    "ì‚°ì—… ë””ìì¸",
    "ì‹œê° ë””ìì¸",
    "ì œí’ˆ ë””ìì¸",
    "ë””ìì´ë„ˆ",
    "ì „ì‹œ",
    "ìŠ¤íŠœë””ì˜¤",
    "ì•„íŠ¸ì„¼í„°",
  ],
  ê±´ì¶•: [
    "ê±´ë¬¼",
    "ì„±",
    "ê¶",
    "íƒ€ì›Œ",
    "ë‹¤ë¦¬",
    "ê±´ì¶•",
    "êµ¬ì¡°ë¬¼",
    "ë„ì‹œê³„íš",
    "ì—­ì‚¬ì  ê±´ì¶•ë¬¼",
    "ì „í†µ ê±´ì¶•",
    "í˜„ëŒ€ ê±´ì¶•",
    "ìŠ¤ì¹´ì´ë¼ì¸",
    "ì§€ë¶•",
    "ì•„ì¹˜",
    "ê³ ë”• ê±´ì¶•",
    "ìœ ëŸ½í’ ê±´ì¶•",
    "ì´ˆê³ ì¸µ ë¹Œë”©",
    "ì „í†µ í•œì˜¥",
  ],
  ìŒì•…: [
    "ê³µì—°",
    "ìŒì•…",
    "ì½˜ì„œíŠ¸",
    "ë²„ìŠ¤í‚¹",
    "ë¬´ëŒ€",
    "ì—°ì£¼",
    "í˜ìŠ¤í‹°ë²Œ",
    "ì¬ì¦ˆ",
    "í´ë˜ì‹",
    "í™í•©",
    "ë¡",
    "EDM",
    "K-POP",
    "DJ",
    "ì˜¤ì¼€ìŠ¤íŠ¸ë¼",
    "ìŠ¤íŠ¸ë¦¬íŠ¸ ê³µì—°",
    "í•©ì°½ë‹¨",
  ],
  ê³µì—°: [
    "ë®¤ì§€ì»¬",
    "ì—°ê·¹",
    "ì˜¤í˜ë¼",
    "ì½˜ì„œíŠ¸",
    "ë¬´ìš©",
    "ì „í†µ ê³µì—°",
    "ì„œì»¤ìŠ¤",
    "ìŠ¤íŠ¸ë¦¬íŠ¸ ê³µì—°",
    "í¼í¬ë¨¼ìŠ¤ ì•„íŠ¸",
    "ì‡¼ì¼€ì´ìŠ¤",
    "ê³µì—°ì¥",
    "ì¦‰í¥ ì—°ê¸°",
    "ê·¹ë‹¨",
  ],
  "K-POP": [
    "ì•„ì´ëŒ",
    "í•œë¥˜",
    "íŒ¬ë¯¸íŒ…",
    "ëŒ„ìŠ¤",
    "ìŒì•… ë°©ì†¡",
    "ì½˜ì„œíŠ¸",
    "ìŠ¤íƒ€ë””ì›€",
    "íŒ¬ë¤",
    "K-POP ê³µì—°",
    "ì—°ìŠµìƒ",
    "ë³´ì´ê·¸ë£¹",
    "ê±¸ê·¸ë£¹",
    "ì„œë°”ì´ë²Œ í”„ë¡œê·¸ë¨",
  ],
  ì—”í„°í…Œì¸ë¨¼íŠ¸: [
    "ì˜í™”",
    "ë“œë¼ë§ˆ",
    "ë†€ì´ê³µì›",
    "í…Œë§ˆíŒŒí¬",
    "ë°©ì†¡êµ­",
    "ê²Œì„",
    "eìŠ¤í¬ì¸ ",
    "ì• ë‹ˆë©”ì´ì…˜",
    "ì½”ë¯¸ë””",
    "í† í¬ì‡¼",
    "ì•„ì¼€ì´ë“œ",
    "ë„·í”Œë¦­ìŠ¤ ì´¬ì˜ì§€",
  ],
  ë¬¸í•™: [
    "ë„ì„œê´€",
    "ì±…ë°©",
    "ì„œì ",
    "ì‹œì¸",
    "ì†Œì„¤",
    "ë¬¸í•™ê´€",
    "ì‘ê°€",
    "ë…ì„œ",
    "ì‹œì§‘",
    "SFì†Œì„¤",
    "íŒíƒ€ì§€",
    "ì¶”ë¦¬ì†Œì„¤",
    "ê³ ì „ë¬¸í•™",
    "ì„œì¬",
    "ë¶í˜ì–´",
  ],
  ê³¼í•™: [
    "ê³¼í•™ê´€",
    "ì²œë¬¸ëŒ€",
    "ì‹¤í—˜",
    "ë°œëª…",
    "ê¸°ìˆ ",
    "ê³µí•™",
    "ì—°êµ¬ì†Œ",
    "ë¡œë´‡",
    "AI",
    "ìš°ì£¼",
    "ì²œì²´ ë§ì›ê²½",
    "ì–‘ì ë¬¼ë¦¬í•™",
    "ìƒë¬¼í•™",
    "ìˆ˜í•™",
    "ì½”ë”©",
  ],
  ìˆ˜í•™: [
    "ìˆ˜í•™",
    "ê³¼í•™ê´€",
    "ì—°êµ¬ì†Œ",
    "í†µê³„",
    "ê¸°í•˜í•™",
    "ìˆ˜ë¦¬ ê³¼í•™",
    "ìˆ˜í•™ ë°•ë¬¼ê´€",
    "ê³„ì‚°",
    "ë…¼ë¦¬í•™",
    "ì•”í˜¸í•™",
    "ìˆ˜í•™ ì²´í—˜ê´€",
  ],
  ê¸°ìˆ : [
    "ê¸°ìˆ ",
    "ê³¼í•™",
    "IT",
    "ì»´í“¨í„°",
    "ë¡œë´‡",
    "AI",
    "VR",
    "AR",
    "ë“œë¡ ",
    "ìŠ¤ë§ˆíŠ¸ ê¸°ê¸°",
    "ì²¨ë‹¨ ê¸°ìˆ ",
    "ì—°êµ¬ì†Œ",
    "í˜ì‹  ì„¼í„°",
  ],
  ê²½ì œ: [
    "ê¸ˆìœµ",
    "ì¦ê¶Œ",
    "ì€í–‰",
    "ê²½ì œ",
    "ì‹œì¥",
    "ìƒì—…",
    "ë¬´ì—­",
    "ê¸°ì—…",
    "ì°½ì—…",
    "íˆ¬ì",
    "ë¹„ì¦ˆë‹ˆìŠ¤",
    "ì¦ê¶Œê±°ë˜ì†Œ",
    "ìƒê³µíšŒì˜ì†Œ",
  ],
  ìŠ¤í¬ì¸ : [
    "ê²½ê¸°ì¥",
    "ì²´ìœ¡ê´€",
    "ì•¼êµ¬",
    "ì¶•êµ¬",
    "ë†êµ¬",
    "ì˜¬ë¦¼í”½",
    "ìš´ë™",
    "ì²´í—˜ ìŠ¤í¬ì¸ ",
    "ìµìŠ¤íŠ¸ë¦¼ ìŠ¤í¬ì¸ ",
    "ì„œí•‘",
    "ìŠ¤ë…¸ë³´ë“œ",
    "ìŠ¤ì¼€ì´íŠ¸ë³´ë“œ",
    "ë§ˆë¼í†¤",
    "ì•”ë²½ ë“±ë°˜",
  ],
  ìë™ì°¨: [
    "ë ˆì´ì‹±",
    "ì „ì‹œì¥",
    "ìë™ì°¨ ë°•ë¬¼ê´€",
    "ëª¨í„°ì‡¼",
    "íŠœë‹",
    "ì „ê¸°ì°¨",
    "ìŠ¤í¬ì¸ ì¹´",
    "í´ë˜ì‹ì¹´",
    "ë“œë˜ê·¸ ë ˆì´ì‹±",
    "ìë™ì°¨ ê²½ì£¼",
    "ë°”ì´í¬",
    "F1",
  ],
  ìš”ë¦¬: [
    "ìŒì‹",
    "ë§›ì§‘",
    "ì‹ë‹¹",
    "ì¹´í˜",
    "ë ˆìŠ¤í† ë‘",
    "ë¨¹ê±°ë¦¬",
    "í‘¸ë“œì½”íŠ¸",
    "ìš”ë¦¬ ì²´í—˜",
    "ê¸¸ê±°ë¦¬ ìŒì‹",
    "ì „í†µ ìŒì‹",
    "í•œì‹",
    "ì–‘ì‹",
    "ì¼ì‹",
    "ì¤‘ì‹",
    "ë””ì €íŠ¸",
    "ë¯¸ìŠë­",
    "ë² ì´ì»¤ë¦¬",
    "ìˆ˜ì œ ë§¥ì£¼",
    "ì „í†µì£¼",
  ],
  ìŒì‹: [
    "ë§›ì§‘",
    "ì‹ë‹¹",
    "ì¹´í˜",
    "ë ˆìŠ¤í† ë‘",
    "ë¨¹ê±°ë¦¬",
    "í‘¸ë“œì½”íŠ¸",
    "ìŒì‹ì ",
    "ì „í†µ ì‹œì¥",
    "ì•¼ì‹œì¥",
    "í‘¸ë“œíŠ¸ëŸ­",
    "ë””ì €íŠ¸",
    "ë² ì´ì»¤ë¦¬",
    "ìŒì‹ ì¶•ì œ",
    "ë¯¸ì‹",
  ],
  íŒ¨ì…˜: [
    "ì‡¼í•‘ëª°",
    "ë””ìì´ë„ˆ",
    "íŒ¨ì…˜ìœ„í¬",
    "ì˜ë¥˜",
    "ì•…ì„¸ì‚¬ë¦¬",
    "ë¸Œëœë“œ",
    "ìŠ¤íƒ€ì¼",
    "íŒ¨ì…˜ ì¡ì§€",
    "ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜",
    "ëª…í’ˆ ë¸Œëœë“œ",
    "ë¹ˆí‹°ì§€ ìƒµ",
    "íŒ¨ì…˜ íŠ¸ë Œë“œ",
  ],
};

// 2) "ì¥ì†Œ ì •ë³´"ë¥¼ ë¶„ì„í•˜ì—¬ ê°€ì¥ ì˜ ë§ëŠ” 'ê´€ì‹¬ì‚¬'ë¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜
export function findMatchingInterest(
  placeTitle: string,
  placeDescription: string,
  userInterests: string[]
): string {
  console.log("ğŸ” [InterestUtils] ê´€ì‹¬ì‚¬ ë§¤ì¹­ ì‹œì‘");
  console.log("ğŸ“ ì¥ì†Œ:", placeTitle);
  console.log("ğŸ“ ì„¤ëª…:", placeDescription);
  console.log("ğŸ‘¤ ì‚¬ìš©ì ê´€ì‹¬ì‚¬:", userInterests);

  // ê¸°ë³¸ê°’: userInterestsê°€ ë¹„ì–´ìˆìœ¼ë©´ 'ì „ì²´' ì‚¬ìš©
  if (!userInterests.length) {
    console.log("âœ¨ ì„ íƒëœ ê´€ì‹¬ì‚¬ ì—†ìŒ -> 'ì „ì²´' ëª¨ë“œë¡œ ì§„í–‰");
    return "ì „ì²´";
  }

  // ìš°ì„ ìˆœìœ„: userInterests ì¤‘ ì²« ë²ˆì§¸ê°€ "ì „ì²´"ë©´ ë’¤ ë¡œì§ í†µê³¼
  if (userInterests[0] === "ì „ì²´") {
    console.log("âœ¨ 'ì „ì²´' ëª¨ë“œë¡œ ì§„í–‰");
    return "ì „ì²´";
  }

  // placeInfo ì†Œë¬¸ìë¡œ ì „ì²˜ë¦¬
  const placeInfo = `${placeTitle} ${placeDescription}`.toLowerCase();

  // ì‚¬ìš©ì ê´€ì‹¬ì‚¬ ì—¬ëŸ¬ ê°œì¸ ê²½ìš°:
  if (userInterests.length > 1) {
    console.log("ğŸ“Š ë‹¤ì¤‘ ê´€ì‹¬ì‚¬ ë§¤ì¹­ ì‹œë„");
    const matchingPreferences = userInterests.filter((pref) => {
      const keywords = keywordMappings[pref] || [];
      // ê´€ì‹¬ì‚¬ ìì²´ê°€ placeInfoì— ë“±ì¥í•˜ê±°ë‚˜,
      // ë¯¸ë¦¬ ì§€ì •í•œ í‚¤ì›Œë“œê°€ placeInfo ì•ˆì— ìˆìœ¼ë©´ ë§¤ì¹­
      const isMatching =
        placeInfo.includes(pref.toLowerCase()) ||
        keywords.some((kw) => placeInfo.includes(kw));

      if (isMatching) {
        console.log(`âœ… ë§¤ì¹­ëœ ê´€ì‹¬ì‚¬: ${pref}`);
        console.log(
          `ğŸ”‘ ë§¤ì¹­ëœ í‚¤ì›Œë“œ:`,
          keywords.filter((kw) => placeInfo.includes(kw))
        );
      }

      return isMatching;
    });

    // ë§¤ì¹­ëœ ê´€ì‹¬ì‚¬ê°€ í•˜ë‚˜ ì´ìƒ ìˆìœ¼ë©´ ëœë¤ìœ¼ë¡œ í•˜ë‚˜ ì„ íƒ
    if (matchingPreferences.length > 0) {
      const selectedPreference =
        matchingPreferences[
          Math.floor(Math.random() * matchingPreferences.length)
        ];
      console.log(`ğŸ¯ ìµœì¢… ì„ íƒëœ ê´€ì‹¬ì‚¬: ${selectedPreference}`);
      return selectedPreference;
    } else {
      // ì•„ë¬´ê²ƒë„ ì•ˆ ë§ìœ¼ë©´ userInterests ì¤‘ì—ì„œ ëœë¤
      const randomPreference =
        userInterests[Math.floor(Math.random() * userInterests.length)];
      console.log(`ğŸ² ë§¤ì¹­ ì‹¤íŒ¨ -> ëœë¤ ì„ íƒ: ${randomPreference}`);
      return randomPreference;
    }
  } else {
    // ë‹¨ì¼ ê´€ì‹¬ì‚¬ì¸ ê²½ìš° í•´ë‹¹ ê´€ì‹¬ì‚¬ ì‚¬ìš©
    console.log(`ğŸ¯ ë‹¨ì¼ ê´€ì‹¬ì‚¬ ì‚¬ìš©: ${userInterests[0]}`);
    return userInterests[0];
  }
}
